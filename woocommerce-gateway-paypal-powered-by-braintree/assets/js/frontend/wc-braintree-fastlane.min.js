(()=>{"use strict";const e=window.wp.i18n;function t(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function a(e,t){if(!e)return;const a=jQuery;a(`#${t}_first_name`).changeVal(e.firstName||""),a(`#${t}_last_name`).changeVal(e.lastName||""),a(`#${t}_address_1`).changeVal(e.streetAddress||""),a(`#${t}_address_2`).changeVal(e.extendedAddress||""),a(`#${t}_city`).changeVal(e.locality||""),a(`#${t}_state`).changeVal(e.region||""),a(`#${t}_postcode`).changeVal(e.postalCode||""),a(`#${t}_country`).changeVal(e.countryCodeAlpha2||""),"billing"===t&&a("#billing_phone").changeVal(e.phoneNumber||"")}function n(){jQuery(".wc-braintree-fastlane-spinner").hide()}function i(t){const a=jQuery,n=a("#wc-braintree-fastlane-contact-section"),i=a("#wc-braintree-fastlane-watermark"),r=n.find("h3");r.hide(),a(".fastlane-email-wrapper").hide(),a("#wc-braintree-fastlane-member-email").remove(),i.insertAfter(r),i.addClass("watermark-logged-in"),a(function(t){return`\n\t\t<div id="wc-braintree-fastlane-member-email" class="wc-braintree-fastlane-member-email">\n\t\t\t<span class="member-email">${t}</span>\n\t\t\t<a href="#" id="wc-braintree-fastlane-logout" class="fastlane-logout-link">${(0,e.__)("Log out","woocommerce-gateway-paypal-powered-by-braintree")}</a>\n\t\t</div>\n\t`}(t)).insertAfter(i)}function r(e,t={}){const a=t[(e||"").toLowerCase()]||t.default;return a?`<img src="${a}" alt="${e}" class="wc-braintree-card-brand-icon" />`:"ðŸ’³"}function s(t,a){return`\n\t\t<span class="selected-label">${(0,e.__)("Selected:","woocommerce-gateway-paypal-powered-by-braintree")}</span>\n\t\t<span class="card-icon">${t}</span>\n\t\t<span class="card-details">â€¢â€¢â€¢â€¢ ${a}</span>\n\t`}function l(t){const{line1:a,line2:n}=function(e){if(!e)return{line1:"",line2:""};const t=`${e.firstName||""} ${e.lastName||""}`.trim(),a=e.streetAddress||"",n=e.locality||"",i=e.region||"",r=e.postalCode||"",s=e.countryCodeAlpha2||"";return{line1:t?`${t}, ${a}`:a,line2:[n,`${i} ${r}`.trim(),s].filter(Boolean).join(", ")}}(t);return`\n\t\t<span class="address-label">${(0,e.__)("Selected:","woocommerce-gateway-paypal-powered-by-braintree")}</span>\n\t\t<span class="address-line">${a}</span>\n\t\t<span class="address-line">${n}</span>\n\t`}function o(e){const t=e?.paymentSource?.card,a=t?.billingAddress||{},{firstName:n,lastName:i}=function(e){if(!e)return{firstName:"",lastName:""};const t=e.split(" "),a=t.pop()||"";return{firstName:t.join(" ")||"",lastName:a}}(t?.name);return{...a,firstName:n,lastName:i}}jQuery.fn.changeVal=function(e){return jQuery(this).val(e).trigger("change")};const c=["#billing_first_name_field","#billing_last_name_field","#billing_company_field","#billing_country_field","#billing_address_1_field","#billing_address_2_field","#billing_city_field","#billing_state_field","#billing_postcode_field","#billing_phone_field"],d=["#shipping_first_name_field","#shipping_last_name_field","#shipping_company_field","#shipping_country_field","#shipping_address_1_field","#shipping_address_2_field","#shipping_city_field","#shipping_state_field","#shipping_postcode_field"];function m(){const e=jQuery;c.forEach((t=>e(t).hide()))}function _(){const e=jQuery;c.forEach((t=>e(t).show()))}function h(){const e=jQuery;d.forEach((t=>e(t).hide()))}function p(){const e=jQuery;d.forEach((t=>e(t).show()))}function f(t){const a=jQuery,n=a(".woocommerce-billing-fields__field-wrapper"),i=a(".shipping_address"),r=a("#ship-to-different-address-checkbox");a("#wc-braintree-fastlane-billing-summary").remove(),a("#wc-braintree-fastlane-shipping-summary").remove(),m(),n.length&&n.prepend(function(t){const a=o(t?.card),n=(0,e.__)("Edit Billing Address","woocommerce-gateway-paypal-powered-by-braintree");return`\n\t\t<div id="wc-braintree-fastlane-billing-summary" class="wc-braintree-fastlane-address-summary">\n\t\t\t<div class="address-content">\n\t\t\t\t${l(a)}\n\t\t\t</div>\n\t\t\t<button type="button" id="wc-braintree-fastlane-edit-billing" class="wc-braintree-fastlane-edit-address-btn">\n\t\t\t\t${n}\n\t\t\t</button>\n\t\t</div>\n\t`}(t)),h(),i.length&&i.prepend(function(t){const a=(0,e.__)("Edit Shipping Address","woocommerce-gateway-paypal-powered-by-braintree");return`\n\t\t<div id="wc-braintree-fastlane-shipping-summary" class="wc-braintree-fastlane-address-summary" style="display: none;">\n\t\t\t<div class="address-content">\n\t\t\t\t${l(t?.shippingAddress)}\n\t\t\t</div>\n\t\t\t<button type="button" id="wc-braintree-fastlane-edit-shipping" class="wc-braintree-fastlane-edit-address-btn">\n\t\t\t\t${a}\n\t\t\t</button>\n\t\t</div>\n\t`}(t)),r.off("change.fastlane").on("change.fastlane",(function(){a(this).is(":checked")?(a("#wc-braintree-fastlane-shipping-summary").show(),h()):a("#wc-braintree-fastlane-shipping-summary").hide()})),r.is(":checked")&&a("#wc-braintree-fastlane-shipping-summary").show()}function u(e){const t=jQuery;e?(_(),t("#wc-braintree-fastlane-billing-summary").hide()):(m(),t("#wc-braintree-fastlane-billing-summary").show())}function b(e){const t=jQuery;e?(p(),t("#wc-braintree-fastlane-shipping-summary").hide()):(h(),t("#wc-braintree-fastlane-shipping-summary").show())}function g(){const e=jQuery;e("#wc-braintree-fastlane-email-modal-overlay").remove(),e(document).off("keydown.fastlaneModal")}jQuery(document).ready((function(c){class d extends window.WC_Braintree_Credit_Card_Payment_Form_Handler{constructor(e){super(e),this.card_icons=this.params.card_icons||{},this.fastlane=null,this.identity=null,this.profile=null,this.profile_data=null,this.fastlane_member=!1,this.current_email=null,this.lookup_completed=!1,this.lookup_in_progress=!1,this.email_confirmed=!1,this.card_component=null,this.selected_card=null,this.authorization_token=null,this.original_payment_box_html=null,this.pending_payment_method_selection=!1,this.billing_edit_mode=!1,this.shipping_edit_mode=!1,this.debounced_lookup=function(e,t){let a;return function(...t){a&&clearTimeout(a),a=setTimeout((()=>{clearTimeout(a),e(...t)}),500)}}(this.perform_email_lookup.bind(this)),this.init()}init(){super.init(),c(document).ready((()=>{this.setup_fastlane_checkout()})),c(document.body).on("updated_checkout",(()=>{this.fastlane?(this.setup_email_field_events(),this.setup_payment_box(),this.fastlane_member&&this.profile_data?(this.member_email&&(i(this.member_email),this.render_watermark(!1),this.setup_logout_handler()),f(this.profile_data),this.setup_address_edit_handlers(),this.billing_edit_mode&&u(!0),this.shipping_edit_mode&&b(!0),this.render_member_payment_ui(this.profile_data.card),this.pending_payment_method_selection&&(this.pending_payment_method_selection=!1,c(`#payment_method_${this.id}`).trigger("click"))):this.lookup_completed&&!this.fastlane_member&&this.handle_non_member()):this.setup_fastlane_checkout()}))}setup_fastlane_checkout(){(function(){const t=jQuery,a=t("#billing_email_field");if(!a.length)return null;if(t("#wc-braintree-fastlane-contact-section").length)return t("#wc-braintree-fastlane-contact-section");const n=t(`\n\t\t<div id="wc-braintree-fastlane-contact-section" class="wc-braintree-fastlane-contact-section">\n\t\t\t<h3>${(0,e.__)("Contact Information","woocommerce-gateway-paypal-powered-by-braintree")}</h3>\n\t\t\t<div class="fastlane-email-wrapper"></div>\n\t\t\t<div id="wc-braintree-fastlane-watermark" class="wc-braintree-fastlane-watermark"></div>\n\t\t</div>\n\t`);a.detach().appendTo(n.find(".fastlane-email-wrapper"));const i=t(`<span class="wc-braintree-fastlane-spinner" role="status" aria-live="polite" style="display: none;">\n\t\t<span class="spinner-icon" aria-hidden="true"></span>\n\t\t<span class="screen-reader-text">${(0,e.__)("Loadingâ€¦","woocommerce-gateway-paypal-powered-by-braintree")}</span>\n\t</span>`),r=a.find(".woocommerce-input-wrapper");r.length&&r.append(i);const s=t("#customer_details");s.length?s.prepend(n):t("form.checkout").prepend(n)})(),this.setup_email_field_events(),this.setup_payment_box(),this.fastlane&&this.render_watermark()}setup_email_field_events(){const e=c("#billing_email");e.length&&(e.off("blur.fastlane input.fastlane change.fastlane"),e.on("blur.fastlane",(()=>{this.handle_email_blur()})),e.on("change.fastlane",(()=>{this.handle_email_blur()})),e.on("input.fastlane",(()=>{e.val().trim()!==this.current_email&&(this.lookup_completed=!1)})),this.check_autofilled_email())}check_autofilled_email(){this.fastlane&&this.identity&&setTimeout((()=>{const e=c("#billing_email"),a=e.val()?.trim();a&&t(a)&&!this.lookup_completed&&!this.email_confirmed&&this.show_email_confirmation_modal(a)}),500)}show_email_confirmation_modal(t){(function(t,a,n,i){const r=jQuery;g(),r("body").append(function(t){const a=(0,e.__)("Confirm your email","woocommerce-gateway-paypal-powered-by-braintree"),n=(0,e.__)("We've detected a pre-filled email. Please confirm it's yours to proceed:","woocommerce-gateway-paypal-powered-by-braintree"),i=(0,e.__)("Continue","woocommerce-gateway-paypal-powered-by-braintree"),r=(0,e.__)("Use a different email","woocommerce-gateway-paypal-powered-by-braintree");return`\n\t\t<div id="wc-braintree-fastlane-email-modal-overlay" class="wc-braintree-fastlane-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="fastlane-modal-title">\n\t\t\t<div class="wc-braintree-fastlane-modal">\n\t\t\t\t<div class="wc-braintree-fastlane-modal-header">\n\t\t\t\t\t<h3 id="fastlane-modal-title" class="wc-braintree-fastlane-modal-title">${a}</h3>\n\t\t\t\t\t<button type="button" class="wc-braintree-fastlane-modal-close" aria-label="${(0,e.__)("Close","woocommerce-gateway-paypal-powered-by-braintree")}">\n\t\t\t\t\t\t<span aria-hidden="true">&times;</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="wc-braintree-fastlane-modal-body">\n\t\t\t\t\t<p class="wc-braintree-fastlane-modal-message">${n} <strong>${t}</strong></p>\n\t\t\t\t\t<button type="button" class="wc-braintree-fastlane-modal-continue">${i}</button>\n\t\t\t\t\t<a href="#" class="wc-braintree-fastlane-modal-use-different">${r}</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="wc-braintree-fastlane-modal-footer">\n\t\t\t\t\t<div id="wc-braintree-fastlane-modal-watermark" class="wc-braintree-fastlane-modal-watermark"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`}(t));const s=r("#wc-braintree-fastlane-email-modal-overlay"),l=s.find(".wc-braintree-fastlane-modal"),o=s.find(".wc-braintree-fastlane-modal-continue"),c=s.find(".wc-braintree-fastlane-modal-use-different"),d=s.find(".wc-braintree-fastlane-modal-close");o.trigger("focus"),o.on("click",(()=>{g(),a&&a()})),c.on("click",(e=>{e.preventDefault(),g(),n&&n()})),d.on("click",(()=>{g(),i&&i()})),s.on("click",(e=>{r(e.target).is(s)&&(g(),i&&i())})),r(document).on("keydown.fastlaneModal",(e=>{"Escape"===e.key&&(g(),i&&i())})),l.on("keydown",(e=>{if("Tab"!==e.key)return;const t=l.find("button, a[href]").filter(":visible"),a=t.first(),n=t.last(),i=l[0].ownerDocument;e.shiftKey&&i.activeElement===a[0]?(e.preventDefault(),n.trigger("focus")):e.shiftKey||i.activeElement!==n[0]||(e.preventDefault(),a.trigger("focus"))}))})(t,(()=>{this.email_confirmed=!0,this.handle_email_blur()}),(()=>{this.email_confirmed=!1,this.lookup_completed=!1,this.current_email=null,c("#billing_email").val("").trigger("focus")})),this.render_modal_watermark()}render_modal_watermark(){this.fastlane&&this.fastlane.FastlaneWatermarkComponent&&c("#wc-braintree-fastlane-modal-watermark").length&&this.fastlane.FastlaneWatermarkComponent({includeAdditionalInfo:!1}).then((e=>{e.render("#wc-braintree-fastlane-modal-watermark")})).catch((e=>{this.log("Failed to render modal watermark.",e,"warn")}))}setup_payment_box(){const e=c(".payment_method_braintree_credit_card .payment_box");if(e.length&&!c("#wc-braintree-fastlane-payment-container").length){this.original_payment_box_html||(this.original_payment_box_html=e.html());const t=this.get_subscription_tokenize_input_html(),a=function(e,t,a=""){return`\n\t\t<div id="wc-braintree-fastlane-payment-container" class="wc-braintree-fastlane-payment-container">\n\t\t\t<div id="wc-braintree-fastlane-payment-content"></div>\n\t\t</div>\n\t\t<input type="hidden" id="wc_${e}_payment_nonce" name="wc_${e}_payment_nonce" />\n\t\t<input type="hidden" id="wc-${t}-device-data" name="wc_braintree_device_data" />\n\t\t${a}\n\t`}(this.id,this.id_dasherized,t);e.html(a)}}get_subscription_tokenize_input_html(){return"1"===c(`input[name="wc-${this.id_dasherized}-cart-contains-subscription"]`).val()?`<input type="hidden" id="wc-${this.id_dasherized}-tokenize-payment-method" name="wc-${this.id_dasherized}-tokenize-payment-method" value="true" />`:""}handle_email_blur(){const e=c("#billing_email").val().trim();e&&t(e)&&(e===this.current_email&&this.lookup_completed||(jQuery(".wc-braintree-fastlane-spinner").show(),this.debounced_lookup(e)))}async perform_email_lookup(e){if(this.fastlane&&this.identity){if(!this.lookup_in_progress){this.lookup_in_progress=!0,this.current_email=e;try{const t=await this.identity.lookupCustomerByEmail(e);if(t.customerContextId){const a=await this.identity.triggerAuthenticationFlow(t.customerContextId);"succeeded"===a.authenticationState?this.handle_authenticated_member(a.profileData,e):(this.fastlane_member=!1,this.handle_non_member())}else this.fastlane_member=!1,this.handle_non_member();this.lookup_completed=!0}catch(e){this.log("Error during Fastlane lookup.",e,"error")}finally{this.lookup_in_progress=!1,n()}}}else n()}setup_braintree(){this.setting_up||this.fastlane||c(`#wc-${this.id_dasherized}-account-number-hosted iframe`).data("ready")||(this.setting_up=!0,this.block_ui(),c(`input[name=wc_${this.id}_payment_nonce]`).val(""),this.create_client())}create_client(){this.get_client_token().done((e=>{if(!e.success)return this.handle_integration_error(e.data);this.authorization_token=e.data,braintree.client.create({authorization:e.data}).then((e=>{this.client=e,this.setup_integration()})).catch((e=>{this.log("Client creation failed.",e,"error"),this.handle_integration_error(e),this.unblock_ui()}))})).fail(((e,t,a)=>{this.log("Failed to get client token.",a,"error"),this.handle_integration_error({message:"Could not retrieve the client token via AJAX: "+a}),this.unblock_ui()}))}setup_integration(){if(this.fastlane)return this.unblock_ui(),void(this.setting_up=!1);if(this.set_device_data(),!braintree.fastlane)return this.log("Fastlane SDK not available, falling back to standard credit card.",null,"warn"),this.render_hosted_fields_fallback();if(!this.client)return this.log("Client not available for Fastlane, falling back to standard credit card.",null,"warn"),this.render_hosted_fields_fallback();const e={authorization:this.authorization_token,client:this.client};braintree.fastlane.create(e).then((e=>{this.fastlane=e,this.identity=e.identity,this.profile=e.profile,this.setup_fastlane_checkout(),this.handle_non_member(),this.check_autofilled_email(),this.unblock_ui(),this.setting_up=!1,c(document).trigger(`wc_${this.id}_fastlane_ready`,this.fastlane)})).catch((e=>{this.log("Fastlane integration failed, falling back to standard credit card.",e,"warn"),this.setting_up=!1,this.render_hosted_fields_fallback()}))}render_watermark(e=!0){if(!this.fastlane||!this.fastlane.FastlaneWatermarkComponent)return;const t=c("#wc-braintree-fastlane-watermark");t.length&&(t.empty(),this.fastlane.FastlaneWatermarkComponent({includeAdditionalInfo:e}).then((e=>{e.render("#wc-braintree-fastlane-watermark")})).catch((e=>{this.log("Failed to render watermark.",e,"warn")})))}handle_authenticated_member(e,t){this.profile_data=e,this.fastlane_member=!0,this.member_email=t,i(t),this.render_watermark(!1),this.setup_logout_handler(),function(e){e&&(a(o(e.card),"billing"),e.shippingAddress&&a(e.shippingAddress,"shipping"))}(e),f(e),this.setup_address_edit_handlers(),this.render_member_payment_ui(e.card),this.pending_payment_method_selection=!0}setup_address_edit_handlers(){c("#wc-braintree-fastlane-edit-billing").off("click.fastlane").on("click.fastlane",(e=>{e.preventDefault(),this.billing_edit_mode=!0,u(!0)})),c("#wc-braintree-fastlane-edit-shipping").off("click.fastlane").on("click.fastlane",(e=>{e.preventDefault(),this.shipping_edit_mode=!0,b(!0)}))}setup_logout_handler(){c("#wc-braintree-fastlane-logout").off("click.fastlane").on("click.fastlane",(e=>{e.preventDefault(),this.handle_logout()}))}handle_logout(){this.fastlane_member=!1,this.profile_data=null,this.selected_card=null,this.member_email=null,this.lookup_completed=!1,this.email_confirmed=!1,this.billing_edit_mode=!1,this.shipping_edit_mode=!1,function(){const e=jQuery,t=e("#wc-braintree-fastlane-contact-section"),a=e("#wc-braintree-fastlane-watermark");e("#wc-braintree-fastlane-member-email").remove(),t.find("h3").show(),e(".fastlane-email-wrapper").show(),e("#billing_email_field").show(),a.removeClass("watermark-logged-in"),a.insertAfter(e(".fastlane-email-wrapper"))}(),function(){const e=jQuery;e("#wc-braintree-fastlane-billing-summary").remove(),e("#wc-braintree-fastlane-shipping-summary").remove(),e("#ship-to-different-address-checkbox").off("change.fastlane"),_(),p()}(),this.render_watermark(!0),c("#billing_email").val("").trigger("change"),this.handle_non_member()}render_member_payment_ui(t){const a=c("#wc-braintree-fastlane-payment-content");if(!a.length)return;this.selected_card=t;const n=function(t,a={}){const n=t?.paymentSource?.card||t,i=n?.brand||(0,e.__)("Card","woocommerce-gateway-paypal-powered-by-braintree"),l=n?.lastDigits||"****",o=r(i,a),c=(0,e.__)("Edit Card","woocommerce-gateway-paypal-powered-by-braintree");return`\n\t\t<div id="wc-braintree-fastlane-member-payment" class="wc-braintree-fastlane-member-payment">\n\t\t\t<div class="wc-braintree-fastlane-selected-card">\n\t\t\t\t${s(o,l)}\n\t\t\t</div>\n\t\t\t<button type="button" id="wc-braintree-fastlane-edit-card" class="button wc-braintree-fastlane-edit-card">\n\t\t\t\t${c}\n\t\t\t</button>\n\t\t</div>\n\t`}(t,this.card_icons);a.html(n),c("#wc-braintree-fastlane-edit-card").off("click.fastlane").on("click.fastlane",(async()=>{await this.handle_edit_card()}))}async handle_edit_card(){if(this.profile&&this.profile.showCardSelector)try{const{selectionChanged:n,selectedCard:i}=await this.profile.showCardSelector();n&&i&&(this.selected_card=i,this.profile_data&&(this.profile_data.card=i),function(t,a={}){const n=t?.paymentSource?.card||t,i=n?.brand||(0,e.__)("Card","woocommerce-gateway-paypal-powered-by-braintree"),l=n?.lastDigits||"****",o=r(i,a);jQuery(".wc-braintree-fastlane-selected-card").html(s(o,l))}(i,this.card_icons),(t=i)&&(a(o(t),"billing"),function(e){const t=jQuery("#wc-braintree-fastlane-billing-summary");if(!t.length||!e)return;const a=o(e);t.find(".address-content").html(l(a))}(t)))}catch(e){this.log("Error showing card selector:",e,"error")}var t}async handle_non_member(){this.setup_payment_box();const e=c("#wc-braintree-fastlane-payment-content");if(e.length){e.html('\n\t\t<div id="wc-braintree-fastlane-card-component" class="wc-braintree-fastlane-card-component">\n\t\t\t\x3c!-- FastlaneCardComponent renders here --\x3e\n\t\t</div>\n\t');try{await this.render_fastlane_card_component()}catch(e){this.log("FastlaneCardComponent failed, falling back to Hosted Fields.",e,"warn"),this.render_hosted_fields_fallback()}}}async render_fastlane_card_component(){if(!this.fastlane||!this.fastlane.FastlaneCardComponent)throw new Error((0,e.__)("FastlaneCardComponent not available","woocommerce-gateway-paypal-powered-by-braintree"));this.card_component&&(c("#wc-braintree-fastlane-card-component").empty(),this.card_component=null);const t=`${c("#billing_first_name").val()||""} ${c("#billing_last_name").val()||""}`.trim(),a=c("#billing_phone").val()||"",n=await this.fastlane.FastlaneCardComponent({fields:{cardholderName:{prefill:t},phoneNumber:{prefill:a}},styles:{root:{backgroundColorPrimary:"#ffffff",colorPrimary:"#0073aa",colorText:"#333333",fontFamily:"inherit"},input:{borderRadius:"4px",borderColor:"#ddd",focusBorderColor:"#0073aa",padding:"12px"},toggle:{colorPrimary:"#0073aa"}}});this.card_component=n,await n.render("#wc-braintree-fastlane-card-component")}render_hosted_fields_fallback(){this.original_payment_box_html&&c(".payment_method_braintree_credit_card .payment_box").html(this.original_payment_box_html),super.setup_integration()}is_selected(){return c(`#payment_method_${this.id}`).is(":checked")}async tokenize_payment(){try{if(this.fastlane_member&&this.selected_card){const e=this.selected_card.id;return c(`input[name=wc_${this.id}_payment_nonce]`).val(e),void this.form.trigger("submit")}if(this.card_component){const t=function(){const e=jQuery;return{firstName:e("#billing_first_name").val()||"",lastName:e("#billing_last_name").val()||"",streetAddress:e("#billing_address_1").val()||"",extendedAddress:e("#billing_address_2").val()||"",locality:e("#billing_city").val()||"",region:e("#billing_state").val()||"",postalCode:e("#billing_postcode").val()||"",countryCodeAlpha2:e("#billing_country").val()||"",phoneNumber:e("#billing_phone").val()||""}}(),a=await this.card_component.getPaymentToken({billingAddress:t});if(a&&a.id)return c(`input[name=wc_${this.id}_payment_nonce]`).val(a.id),void this.form.trigger("submit");throw new Error((0,e.__)("Failed to get payment token from FastlaneCardComponent","woocommerce-gateway-paypal-powered-by-braintree"))}super.tokenize_payment()}catch(t){this.log("tokenize_payment error:",t,"error"),this.handle_error(t.message||(0,e.__)("Payment processing failed","woocommerce-gateway-paypal-powered-by-braintree"))}}handle_error(e){this.unblock_ui();const t=c(".woocommerce-notices-wrapper").first();t.length&&(t.html(`<div class="woocommerce-error">${e}</div>`),c("html, body").animate({scrollTop:t.offset().top-100},500))}}window.WC_Braintree_Fastlane_Payment_Form_Handler=d,c(document.body).trigger("wc_braintree_fastlane_payment_form_handler_loaded")}))})();